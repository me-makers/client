<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Shop Homepage - Start Bootstrap Template</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
  </head>

  <body>
    <div id="app">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="#">Me-Maker</a>

        <div class="header-right">
          <input type="text" placeholder="username / email">
          <input type="password" placeholder="password">
          <button class="btn-info">Login</button>
        </div>
      </div>
    </nav>

    <!-- Page Content -->
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <div class="twPc-div">
            <a class="twPc-bg twPc-block bg-info"></a>
          	<div>
          		<a title="Mert S. Kaplan" href="https://twitter.com/mertskaplan" class="twPc-avatarLink">
          			<img alt="Mert S. Kaplan" src="https://mertskaplan.com/wp-content/plugins/msk-twprofilecard/img/mertskaplan.jpg" class="twPc-avatarImg">
          		</a>

          		<div class="twPc-divUser">
          			<div class="twPc-divName">
          				<a href="https://twitter.com/mertskaplan">Mert S. Kaplan</a>
          			</div>
          			<span>
          				<a href="https://twitter.com/mertskaplan">@<span>mertskaplan</span></a>
          			</span>
          		</div>

          		<div class="twPc-divStats">
          			<ul class="twPc-Arrange">
          				<li class="twPc-ArrangeSizeFit">
          					<a href="https://twitter.com/mertskaplan" title="9.840 Tweet">
          						<span class="twPc-StatLabel twPc-block">Tweets</span>
          						<span class="twPc-StatValue">9.840</span>
          					</a>
          				</li>
          				<li class="twPc-ArrangeSizeFit">
          					<a href="https://twitter.com/mertskaplan/following" title="885 Following">
          						<span class="twPc-StatLabel twPc-block">Following</span>
          						<span class="twPc-StatValue">885</span>
          					</a>
          				</li>
          				<li class="twPc-ArrangeSizeFit">
          					<a href="https://twitter.com/mertskaplan/followers" title="1.810 Followers">
          						<span class="twPc-StatLabel twPc-block">Followers</span>
          						<span class="twPc-StatValue">1.810</span>
          					</a>
          				</li>
          			</ul>
          		</div>
          	</div>
          </div>

          <div class="card  mb-3" style="max-width: 18rem;">
            <div class="card-body">
              <input type="text" placeholder="Search from popular list...">
              <button class="btn-info">Search</button>
            </div>
          </div>
          <button @click='getPopMeme'>Get 100 Most Popular Memes</button>

          <div class="card  mb-3" style="max-width: 18rem;">
            <div class="card-body">
              <h5 class="card-title">Recently Followed</h5>
              
            </div>
          </div>

        </div>
        <!-- /.col-lg-3 -->

        <div class="col-lg-6">
            <!-- <div class="getMeme">
                
                <div class="popMeme" v-for='meme in popMemeList'>
                  <img src="{{ meme }}" alt="">
                </div>
              </div> -->
          <div class="row">
            <div class="col-lg-12 col-md-12 mb-12 form-horizontal" >
              <div class="form-group">
                <button class="btn-success" @click='showCreateForm=true'>I want to make new MEME !</button>
              </div>
            </div>
          </div>
          <hr>
          <!-- FORM -->
            <div class='content-wrapper' v-if='showCreateForm'>
              <div class='meme' id='capture'>
                <div class='content'>
                  <h1 style="text-align: center">{{ text_top }}</h1>
                  <img v-bind:src='image' v-if='image'>
                  <img src="//placehold.it/500x500" v-else>
                  <h1 style="text-align: center">{{ text_bottom }}</h1>
                </div>
              </div>
              <div class='update'><br>
                <label id="text-top">Caption top</label><br>
                <input v-model='text_top'><br><br>
                <label id="text-bottom">Caption Bottom</p>
                <input v-model='text_bottom'><br><br>
                <p>From URL</p>
                <input id="imgURL" class="block" v-model='image' type="text" placeholder="Link to image" :disabled="isDisabled"/>
                <p>From Local Disk</p>
                <input id="imgFile" type="file" accept="image/*" ref="file" v-on:change="handleFileUpload()"/><br><br>
                <button class="btn btn-success" @click='saveMeme'>Create Meme</button>
              </div>
              <div id="block"></div>
              <!-- <div id="capture" style="padding: 10px; background: #f5da55">
                <h4 style="color: #000; ">Hello world!</h4>
              </div> -->
            </div>
            
          <!-- FORM END -->
          <!-- <div className="ui fluid image">
              <img src='http://i.imgflip.com/1bij.jpg'/>
              <div style="position: absolute; bottom: 0px; width: 100%; height: auto;">TEST</div>
          </div> -->

          <div class="make-meme"></div>

          <div class="row" v-for='meme in popMemeList'>
            <div class="col-lg-12 col-md-12 timeline-wrapper" >
              <div class="media ">
                <img class="d-flex" :src='meme.url' alt="">
                <span class="media-body twit-status">
                  <h5 class="mt-0">{{ meme.name }}</h5><br>
                </span>
              </div>
            </div>
          </div>
          
          <!-- /.row -->

        </div>
        <!-- /.col-lg-6 -->
        
        <div class="col-lg-3">
          <div class="card  mb-3" style="max-width: 18rem;">
            <div class="card-body who-to-follow">
              <h5 class="card-title">List of popular memes: <small><a href="#">Refresh</a></small></h5>
              <div class="row" v-for='meme in popMemeList'>
                <span class="media-body twit-status">
                  <h5 class="mt-0">{{ meme.name }}: </h5><br>
                </span>
                  <div class="col-lg-12 col-md-12 timeline-wrapper" >
                    <div class="media ">
                      <img class="d-flex" :src='meme.url' alt="">
                    </div>
                    <button class="btn btn-sm btn-warning" v-if='showCreateForm' @click='choosePopMeme(meme.url)'>Choose this meme instead</button>
                  </div>
                </div>
            </div>
          </div>

        </div>
        <!-- /.col-lg-3 -->

      </div>
      <!-- /.row -->

    </div>
  </div>
    <!-- /.container -->>
    <!-- SCRIPT -->

    <script src="./script.js"></script>
    <script>
    let app = new Vue ({
      el:'#app',
      data: {
        popMemeList: [],
        popMemeUrl: '',
        selectedUrlImage: '',
        image: '',
        text_top: '',
        text_bottom: '',
        showCreateForm: false,
        isDisabled: false

      },
      created() {
        this.getPopMeme()
      },
      watcher() {
      },
      methods: {
        saveMeme() {
          let block = document.getElementById('block')
          let capture = document.getElementById('capture')
          capture.className = 'no-scroll'
          if (block.hasChildNodes()) {
              block.removeChild(block.childNodes[0]);
          }
          html2canvas(document.getElementById('capture'), { allowTaint : true, onrendered: (canvas => {
              capture.className = 'no-scroll'
              block.appendChild(canvas)
            })
          })
        },
        getImage() {
          console.log('setelah berubah', this.image)
          return this.image
        },
        choosePopMeme(url) {
          console.log('before', this.image)
          this.image = url
          console.log('after', this.image)
        },
        getPopMeme() {
          axios.get('https://api.imgflip.com/get_memes')
          .then((result) => {
            // console.log(result)
            app.popMemeList = result.data.data.memes
            console.log(app.popMemeList[0].url)
          }).catch((err) => {
            console.log(err)
          });
        },
        handleFileUpload(){
          this.isDisabled = true
          this.file = this.$refs.file.files[0];
          let reader  = new FileReader();

          reader.addEventListener('load', function () {
            // this.showPreview = true;
            this.image = reader.result;
          }.bind(this), false);

          if( this.file ){
            if ( /\.(jpe?g|png|gif)$/i.test( this.file.name ) ) {
              reader.readAsDataURL( this.file );
            }
          }
        }
      }
    })
    
    </script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  </body>

</html>
